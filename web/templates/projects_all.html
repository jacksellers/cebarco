{% extends "base.html" %}
{% load humanize %}


{% block description %}

{% endblock %}


{% block title %}
All projects
{% endblock %}


{% block head %}

{% endblock %}


{% block content %}
<div class="container">
    <div class="row">
        <div class="col-sm">
            <h3 style="text-align: center;"><b>Projects</b></h3>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-sm">
            <div class="btn-toolbar justify-content-md-center" role="toolbar" aria-label="Toolbar with button groups">
                <div class="btn-group mr-2" role="group" aria-label="First group">
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>All</button>
                </div>
                <div class="btn-group mr-2" role="group" aria-label="Second group">
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>Building</button>
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>Infrastructure</button>
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>Motorsport</button>
                </div>
                <div class="btn-group mr-2" role="group" aria-label="Third group">
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>Current</button>
                    <button id="btn-table" type="button" class="btn btn-secondary" disabled>Completed</button>
                </div>
                <a href="{% url 'web:projects' %}">
                    <div class="btn-group mr-2" role="group" aria-label="Fourth group">
                        <button id="btn-table" type="button" class="btn btn-info"><i class="fas fa-table"></i></button>
                    </div>
                </a>
              </div>
        </div>
    </div>
</div>
<br>
<div class="container">
    <div class="row">
        <div class="col-sm table-responsive">
            <table id="projects-all" class="table table-striped">
                <thead>
                  <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Category</th>
                    <th scope="col">Client</th>
                    <th scope="col">Consulting engingeer</th>
                    <th scope="col">Completion</th>
                    <th scope="col">Period</th>
                    <th scope="col">Price</th>
                  </tr>
                </thead>
                <tbody>
                    {% for project in projects %}
                        <tr>
                            <th scope="row"><a href="{% url 'web:project' slug=project.slug %}">{{ project.name }}</a></th>
                            {% if project.category == 'building' %}
                                <td><span class="category-span">{{ project.category|title }} <i class="fas fa-building"></i></span></td>
                            {% elif project.category == 'infrastructure' %}
                                <td><span class="category-span">{{ project.category|title }} <i class="fas fa-wrench"></i></span></td>
                            {% else %}
                                <td><span class="category-span">{{ project.category|title }} <i class="fas fa-car"></i></span></td>
                            {% endif %}
                            <td>{{ project.client }}</td>
                            <td>{{ project.consulting_engineer }}</td>
                            <td>{{ project.contract_completion|date:"M Y" }}</td>
                            <td>{{ project.contract_period }} months</td>
                            {% if project.undisclosed %}
                                <td>Undisclosed</td>
                            {% else %}
                                <td>${{ project.contract_price|intcomma }}</td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
        $.tablesorter.addParser(
            {
                id: 'monthYear',
                is: function(s) {
                    return false;
                },
                format: function(s) {
                    // remove extra spacing
                    s = $.trim(s.replace(/\s+/g, ' '));
                    // process date
                    var date = s.match(/^(\w{3})[ ](\d{4})$/),
                        m = date ? date[1] + ' 1 ' || '' : '',
                        y = date && date[2] ? date[2] || '' : '';
                    return new Date(m + y).getTime() || '';
                },
                type: 'Numeric'
            }
        );
        $('#projects-all').tablesorter(
            {
                headers: {
                    4: {sortInitialOrder: 'desc', sorter: 'monthYear'},
                    5: { sortInitialOrder: 'desc' },
                    6: { sortInitialOrder: 'desc', sorter: 'digit', string: 'min' }
                }
            }
        );
        $('th').hover(function() {
            $(this).css('cursor','pointer');
        });
    });
    </script>
{% endblock %}
